

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Remote Warehousing &mdash; Kids First Data Ingest Libraries  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/style.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Load Stage Design" href="load.html" />
    <link rel="prev" title="Transform Stage" href="transform.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="overview.html">Design Overview</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="value_principles.html">Value Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="extract_mapping.html">Extract Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="transform.html">Transform Stage</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Remote Warehousing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#warehouse-server-requirements">Warehouse Server Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#local-environment-configuration">Local Environment Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cli-temporary-disabling">CLI Temporary Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#storage-layout">Storage Layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lifecycle">Lifecycle</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="load.html">Load Stage Design</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">How To</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Kids First Data Ingest Libraries</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="overview.html">Design Overview</a> &raquo;</li>
        
      <li>Remote Warehousing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/design/warehousing.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="remote-warehousing">
<span id="warehousing"></span><h1>Remote Warehousing<a class="headerlink" href="#remote-warehousing" title="Permalink to this headline">¶</a></h1>
<p>Sharing is caring, so storing ingest debugging data only on your own computer
is bad news bears. With minimal configuration, the ingest system can connect to
a remote warehousing database to centrally store your package’s intermediate
Extract and Transform results as well as the KFID lookup cache for the study.
This makes it easier for others to assist in replicating, validating, and
modifying the results of an ingest.</p>
<div class="section" id="warehouse-server-requirements">
<h2>Warehouse Server Requirements<a class="headerlink" href="#warehouse-server-requirements" title="Permalink to this headline">¶</a></h2>
<p>The technical requirements for warehousing are:</p>
<ol class="arabic simple">
<li>A database server that supports namespace schemas (ask your group
administrator if one has already been set up)<ul>
<li>PostgreSQL will work</li>
<li>MySQL will <strong>not</strong> work</li>
</ul>
</li>
<li>An account on the database server with sufficient access permissions to
invoke <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">DATABASE</span></code>, <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">SCHEMA</span></code>, <code class="docutils literal notranslate"><span class="pre">DROP</span> <span class="pre">SCHEMA</span></code>,
<code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code>, <code class="docutils literal notranslate"><span class="pre">DROP</span> <span class="pre">TABLE</span></code>, and <code class="docutils literal notranslate"><span class="pre">INSERT</span></code></li>
<li>The power of friendship</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Connection details for the warehouse used for ingesting Kids First studies
can be found at <a class="reference external" href="https://github.com/d3b-center/clinical-data-flow/tree/master/warehouse">https://github.com/d3b-center/clinical-data-flow/tree/master/warehouse</a></p>
</div>
</div>
<div class="section" id="local-environment-configuration">
<h2>Local Environment Configuration<a class="headerlink" href="#local-environment-configuration" title="Permalink to this headline">¶</a></h2>
<p>In your local environment, set a variable called <code class="docutils literal notranslate"><span class="pre">KF_WAREHOUSE_DB_URL</span></code>
containing a complete login URL, including username and password if needed,
that can be used for calling <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">DATABASE</span></code> on the server, like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">KF_WAREHOUSE_DB_URL</span><span class="o">=</span><span class="n">postgresql</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">username</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">password</span><span class="o">&gt;@&lt;</span><span class="n">address</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">port</span><span class="o">&gt;/</span><span class="n">postgres</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">PostgreSQL requires all connections to go directly to a database regardless
of what you’re doing, so we use the default “postgres” database for this.</p>
</div>
<p>If this variable is set, the ingest system will use the designated server as a
central warehouse. If this environment variable is not set, then it will skip
warehousing.</p>
</div>
<div class="section" id="cli-temporary-disabling">
<h2>CLI Temporary Disabling<a class="headerlink" href="#cli-temporary-disabling" title="Permalink to this headline">¶</a></h2>
<p>If you don’t want to use the warehouse during a run for any reason, the
<code class="docutils literal notranslate"><span class="pre">--no_warehouse</span></code> command line argument will make the system treat the
<code class="docutils literal notranslate"><span class="pre">KF_WAREHOUSE_DB_URL</span></code> environment variable as not set.</p>
</div>
<div class="section" id="storage-layout">
<h2>Storage Layout<a class="headerlink" href="#storage-layout" title="Permalink to this headline">¶</a></h2>
<p>After ingesting a study, the warehouse server should have a database named
after the study KFID.</p>
<img alt="../_images/warehouse_db.png" src="../_images/warehouse_db.png" />
<p>Inside that database you should find schemas for each of the warehoused stages
prefixed by “Ingest:” and the name of the package. Each schema table will be
one of that stage’s returned DataFrames.</p>
<img alt="../_images/warehouse_inside_db.png" src="../_images/warehouse_inside_db.png" />
</div>
<div class="section" id="lifecycle">
<h2>Lifecycle<a class="headerlink" href="#lifecycle" title="Permalink to this headline">¶</a></h2>
<p>Whenever you ingest a package, that package’s prior existing schemas will be
replaced.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="load.html" class="btn btn-neutral float-right" title="Load Stage Design" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="transform.html" class="btn btn-neutral float-left" title="Transform Stage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Kids First

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>