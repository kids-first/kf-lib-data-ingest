

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Understanding the Load Stage &mdash; Kids First Data Ingest Libraries  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/other.css" type="text/css" />
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Developers" href="../developer.html" />
    <link rel="prev" title="Using a Target Service Plugin" href="target_service_plugins/how_to_use.html" />
    <link rel="stylesheet" href="https://kids-first.github.io/kf-sphinx-docs-theme/sphinx_kidsfirst_theme/static/css/kidsfirst.css" type="text/css" />
 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design/overview.html">Design Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="app.html">Kids First Ingest App</a></li>
<li class="toctree-l2"><a class="reference internal" href="ingest_package.html">New Ingest Package Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="extract/index.html">Extract Stage</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">Testing Your Ingest Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="extract/challenge_scenarios/index.html">Common Challenges when Extracting</a></li>
<li class="toctree-l2"><a class="reference internal" href="sourcing_data/index.html">Sourcing Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="transform.html">Transform Stage</a></li>
<li class="toctree-l2"><a class="reference internal" href="target_service_plugins/index.html">Target Service Plugins</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Understanding the Load Stage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-the-load-stage-expects">What the Load Stage Expects</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-the-load-stage-on-its-own">Using The Load Stage On Its Own</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Kids First Data Ingest Libraries</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Tutorial</a> &raquo;</li>
        
      <li>Understanding the Load Stage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorial/load.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="understanding-the-load-stage">
<span id="tutorial-load-stage"></span><h1>Understanding the Load Stage<a class="headerlink" href="#understanding-the-load-stage" title="Permalink to this heading">¶</a></h1>
<section id="what-the-load-stage-expects">
<span id="tutorial-load-stage-expects"></span><h2>What the Load Stage Expects<a class="headerlink" href="#what-the-load-stage-expects" title="Permalink to this heading">¶</a></h2>
<p>The Load stage expects to receive a dictionary of pandas DataFrames keyed by
hints about which data can be found in the tables.</p>
<p>Example input:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">pandas</span> <span class="n">DataFrame</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s2">&quot;phenotypes&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">pandas</span> <span class="n">DataFrame</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s2">&quot;family_relationships&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">pandas</span> <span class="n">DataFrame</span> <span class="mi">3</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The keys must either be the value of a <code class="docutils literal notranslate"><span class="pre">class_name</span></code> attribute from one of
your target service plugin’s included entity builders or <code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code> (where the
<code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code> entry will be used for any entity builder that isn’t explicitly named
in the dict), and each DataFrame must contain all of the necessary data used by
its respective target service entity builder.</p>
<p>In the above example, if building <code class="docutils literal notranslate"><span class="pre">&quot;phenotypes&quot;</span></code> requires knowing who is
being described, what characteristic they have, and when the characteristic was
observed, the attached DataFrame must therefore include those values.</p>
</section>
<section id="using-the-load-stage-on-its-own">
<h2>Using The Load Stage On Its Own<a class="headerlink" href="#using-the-load-stage-on-its-own" title="Permalink to this heading">¶</a></h2>
<p>If your data is already appropriately standardized, you don’t need to use the
Extract and Transform stages in order to use the Load Stage. The Load stage can
be invoked on its own in Python like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kf_lib_data_ingest.common.io</span> <span class="kn">import</span> <span class="n">read_df</span>
<span class="kn">from</span> <span class="nn">kf_lib_data_ingest.etl.load.load_shim</span> <span class="kn">import</span> <span class="n">LoadStage</span>

<span class="n">path_to_my_target_service_plugin</span> <span class="o">=</span> <span class="s2">&quot;foo/bar/my_plugin.py&quot;</span>
<span class="n">target_service_base_url</span> <span class="o">=</span> <span class="s2">&quot;https://my_service:8080&quot;</span>
<span class="n">list_of_class_names_to_load</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;patient&quot;</span><span class="p">,</span> <span class="s2">&quot;family_relationship&quot;</span><span class="p">,</span> <span class="s2">&quot;specimen&quot;</span><span class="p">]</span>
<span class="n">study_id</span> <span class="o">=</span> <span class="s2">&quot;SD_ME0WME0W&quot;</span>
<span class="n">path_to_cache_storage_directory</span> <span class="o">=</span> <span class="s2">&quot;foo/bar/my_output&quot;</span>

<span class="n">LoadStage</span><span class="p">(</span>
    <span class="n">path_to_my_target_service_plugin</span><span class="p">,</span>
    <span class="n">target_service_base_url</span><span class="p">,</span>
    <span class="n">list_of_class_names_to_load</span><span class="p">,</span>
    <span class="n">study_id</span><span class="p">,</span>
    <span class="n">path_to_cache_storage_directory</span>
<span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="n">read_df</span><span class="p">(</span><span class="s2">&quot;my_input/default.tsv&quot;</span><span class="p">),</span>
        <span class="s2">&quot;family_relationship&quot;</span><span class="p">:</span> <span class="n">read_df</span><span class="p">(</span><span class="s2">&quot;my_input/family_relationships.tsv&quot;</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>As mentioned, you may choose to do this if all of your incoming data is
guaranteed to be in a strict standardized format that requires no special
slicing, chopping, or blending.</p>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../developer.html" class="btn btn-neutral float-right" title="Developers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="target_service_plugins/how_to_use.html" class="btn btn-neutral float-left" title="Using a Target Service Plugin" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Kids First

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>